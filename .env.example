# ============================================================================
# Polymarket Sniper Bot - Environment Configuration
# ============================================================================
#
# Following pmxt methodology: https://github.com/pmxt-dev/pmxt/blob/main/core/docs/SETUP_POLYMARKET.md
# The most you need is a private key - everything else has sensible defaults!
#

# ============================================================================
# MINIMAL REQUIRED CONFIGURATION (Just like pmxt!)
# ============================================================================
# Only these 3 variables are required to get started:

# 1. Your Polygon wallet private key (required)
#    - Used for signing transactions and deriving CLOB credentials
#    - Include the 0x prefix or not - both work
PRIVATE_KEY=your_private_key_here

# 2. Polygon RPC URL (required)
RPC_URL=https://polygon-rpc.com

# 3. Target addresses to monitor (optional for copy trading)
#    - If set: Comma-separated list of addresses (no spaces)
#    - If NOT set: Automatically fetches top 20 traders from Polymarket leaderboard
TARGET_ADDRESSES=0xabc...,0xdef...

# That's it! The bot automatically:
# - Derives CLOB API credentials from your private key
# - Uses EOA signature type (0) by default
# - Uses the official Polygon USDC.e address and decimals
# - Auto-detects your wallet type and auth method
# - Fetches target addresses from leaderboard if not specified

# ============================================================================
# EVERYTHING BELOW IS OPTIONAL - Only change if you need to customize
# ============================================================================

# ----------------------------------------------------------------------------
# Leaderboard Target Addresses (Optional)
# ----------------------------------------------------------------------------
# If TARGET_ADDRESSES is not set, the bot fetches top traders from the
# Polymarket leaderboard. These settings control that behavior:
#
# LEADERBOARD_LIMIT: Number of top traders to fetch (max: 50, default: 20)
# LEADERBOARD_LIMIT=20
#
# LEADERBOARD_ENABLE_CACHE: Enable disk caching of leaderboard data (default: false)
# By default, the system is stateless and fetches fresh data on each startup.
# Set to true if you want to cache data to disk for faster restarts.
# LEADERBOARD_ENABLE_CACHE=false
#
# LEADERBOARD_TTL_SECONDS: How long cached data is valid (default: 3600 = 1 hour)
# Only used when LEADERBOARD_ENABLE_CACHE=true
# LEADERBOARD_TTL_SECONDS=3600
#
# LEADERBOARD_CACHE_FILE: Path to cache file (default: .leaderboard-cache.json)
# Only used when LEADERBOARD_ENABLE_CACHE=true
# LEADERBOARD_CACHE_FILE=.leaderboard-cache.json

# ----------------------------------------------------------------------------
# Network Configuration (Optional)
# ----------------------------------------------------------------------------
# Public key/address (optional, for validation - derived from PRIVATE_KEY if omitted)
# PUBLIC_KEY=0x0000000000000000000000000000000000000000

# ----------------------------------------------------------------------------
# CLOB Authentication (Optional - auto-derives from PRIVATE_KEY by default)
# ----------------------------------------------------------------------------
# Credential derivation is ENABLED BY DEFAULT (just like pmxt)
# Only set to false if you want to use explicit credentials
# CLOB_DERIVE_CREDS=true

# Manual CLOB Credentials (only if you have explicit credentials)
# These must be created programmatically - there is NO web UI to generate them
# POLYMARKET_API_KEY=your_clob_api_key_here
# POLYMARKET_API_SECRET=your_clob_api_secret_here
# POLYMARKET_API_PASSPHRASE=your_clob_passphrase_here

# Signature type (0=EOA is default, 1=PROXY, 2=GNOSIS_SAFE)
# POLYMARKET_SIGNATURE_TYPE=0

# Proxy/Safe address (only needed for signature type 1 or 2)
# POLYMARKET_PROXY_ADDRESS=0x...

# ----------------------------------------------------------------------------
# Collateral Token Configuration (Optional - defaults to official USDC.e)
# ----------------------------------------------------------------------------
# USDC.e on Polygon (these are the official defaults)
# COLLATERAL_TOKEN_ADDRESS=0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174
# COLLATERAL_TOKEN_DECIMALS=6

# ----------------------------------------------------------------------------
# Trading Configuration (Optional)
# ----------------------------------------------------------------------------
# Trade execution mode (clob or onchain)
# - clob (DEFAULT/RECOMMENDED): Uses Polymarket CLOB API
#         Requires API credentials (auto-derived from PRIVATE_KEY by default)
#         Full trading functionality with advanced order types
# - onchain (EXPERIMENTAL): Infrastructure for direct blockchain trading
#           Currently NOT FULLY IMPLEMENTED - returns NOT_IMPLEMENTED error
#           Requires additional integration work (see ONCHAIN_TRADING_IMPLEMENTATION.md)
#           Only use for development/testing of on-chain integration
# TRADE_MODE=clob

# Enable live trading (must be exactly this value to trade real money)
# ARB_LIVE_TRADING=I_UNDERSTAND_THE_RISKS

# Minimum trade sizes
# MIN_TRADE_SIZE_USD=100
# MIN_ORDER_USD=10

# Minimum price threshold for copy trade BUY orders (0.0-1.0 scale, default: 0.50 = 50Â¢)
# Prevents copying trades into low-probability "loser" positions.
# This is a SAFETY feature - copy trades at low prices are extremely risky.
# Does NOT affect SELL orders or other strategies (endgame-sweep has its own controls).
#
# Recommended values:
# - 0.15 (15Â¢): Aggressive, blocks only extreme losers
# - 0.25 (25Â¢): Moderate, blocks most risky positions  
# - 0.50 (50Â¢): Conservative default, only copy trades close to fair odds
# MIN_BUY_PRICE=0.50

# ----------------------------------------------------------------------------
# Low-Price Volatile Scalping (Optional) - ONE SETTING CONTROLS EVERYTHING
# ----------------------------------------------------------------------------
# Set this to enable scalping volatile low-price positions.
# Example: SCALP_LOW_PRICE_THRESHOLD=0.20 means:
#   1. Allow BUYING at 20Â¢ or below (bypasses MIN_BUY_PRICE for these trades)
#   2. Take ANY profit immediately on positions bought at â‰¤20Â¢
#   3. If no profit within the time window, exit to avoid holding losers forever
#
# This is perfect for copy trading volatile low-price positions - whale buys
# at 5Â¢, you copy it, price moves up, you take profit immediately.
# SCALP_LOW_PRICE_THRESHOLD=0.20

# Maximum time (minutes) to hold low-price positions without profit before exiting.
# Prevents holding volatile losers forever. After this time, exits at breakeven or small loss.
# Set to 0 to disable (hold indefinitely). Default: 3 minutes (quick scalps!)
# SCALP_LOW_PRICE_MAX_HOLD_MINUTES=3

# Frontrun order sizing
# FRONTRUN_SIZE_MULTIPLIER: Percentage of target trade to frontrun (0.0-1.0, default: 0.5 = 50%)
# FRONTRUN_MAX_SIZE_USD: Maximum USD size for any frontrun order (caps the calculated size)
# Note: Frontrun size is also capped by MAX_POSITION_USD if set (uses the lower of both)
# FRONTRUN_SIZE_MULTIPLIER=0.5
# FRONTRUN_MAX_SIZE_USD=50

# ----------------------------------------------------------------------------
# Profit Thresholds (Optional)
# ----------------------------------------------------------------------------
# Minimum absolute profit in USD for quick-flip sells
# Ensures trades generate meaningful profits, not just 5-cent scalps
# Example: On a $5 position, 5% gain = $0.25 profit (meets default threshold)
# QUICK_FLIP_MIN_PROFIT_USD=0.25

# ----------------------------------------------------------------------------
# Auto-Sell Configuration (Optional)
# ----------------------------------------------------------------------------
# Automatically sell positions to free up capital for new trades.
# This includes near-resolution positions and "stale" profitable positions.

# Near-Resolution Auto-Sell:
# Sell positions at 99.9Â¢+ to free capital instead of waiting for redemption.
# AUTO_SELL_ENABLED=true                     # Enable auto-sell (default: true)
# AUTO_SELL_THRESHOLD=0.999                  # Price threshold (0.999 = 99.9Â¢)
# AUTO_SELL_MIN_HOLD_SEC=60                  # Min hold time before selling (default: 60s)

# Dispute Window Exit:
# Exit positions at 99.9Â¢+ immediately to avoid 2-hour dispute hold wait.
# AUTO_SELL_DISPUTE_EXIT_ENABLED=true        # Enable dispute exit (default: true)
# AUTO_SELL_DISPUTE_EXIT_PRICE=0.999         # Exit price (0.999 = 99.9Â¢)

# Stale Profitable Position Exit:
# Sell profitable positions held too long to free up capital for new trades.
# These are positions that are "in the green" but have been held for a long time,
# tying up capital that could be used for new trades.
#
# REASONING: There's no reason to hold capital in positions that:
# - Are profitable (green)
# - Have been held for 24+ hours
#
# By selling these, you lock in the profit and free the capital for new opportunities.
#
# AUTO_SELL_STALE_POSITION_HOURS=24          # Hours before a profitable position is "stale"
#                                            # Set to 0 to disable (default: 24 hours)
#                                            # Aggressive preset uses 12 hours

# Quick Win Exit:
# Sell positions held less than an hour with massive gains (>90% by default).
# This targets positions that spike significantly in a short time window,
# locking in profit before momentum reverses.
#
# KEY FEATURE: Uses profit % based on purchase price, NOT share price.
# Example: Bought at 10Â¢, now 19Â¢ = 90% gain â†’ quick win exit
# This avoids conflicts with positions bought at high prices (e.g., 80Â¢).
#
# REASONING: Quick momentum wins should be captured before they reverse.
# If you bought at 10Â¢ and the price jumps to 19Â¢ in 30 minutes, that's
# a 90% gain that may not last. Lock it in and redeploy the capital.
#
# AUTO_SELL_QUICK_WIN_ENABLED=false          # Enable quick win exit (default: false, opt-in)
# AUTO_SELL_QUICK_WIN_MAX_HOLD_MINUTES=60    # Max hold time for quick win (default: 60 minutes)
# AUTO_SELL_QUICK_WIN_PROFIT_PCT=90          # Profit % threshold (default: 90%)
#                                            # Example: 90 means 90% profit from purchase price

# ----------------------------------------------------------------------------
# Auto-Redeem Configuration (Optional)
# ----------------------------------------------------------------------------
# Automatically claim resolved market positions to recover USDC
# When a market resolves, your winning/losing positions can be redeemed
# AUTO_REDEEM_ENABLED=true              # Enable automatic redemption (default: true)
# AUTO_REDEEM_MIN_POSITION_USD=0        # Skip dust positions below this value (default: 0 = no minimum, redeem everything)
#                                       # Set to a higher value like 0.01 to skip micro-positions worth less than 1 cent
# AUTO_REDEEM_CHECK_INTERVAL_MS=30000   # How often to check for redeemable positions (default: 30000ms = 30 seconds)
#                                       # Lower values = more responsive but more API calls
#                                       # Higher values = less responsive but fewer API calls

# Strategy Preset (enables all strategies including auto-redeem)
# Presets: off, conservative, balanced, aggressive
# STRATEGY_PRESET=balanced

# ----------------------------------------------------------------------------
# Position Stacking Configuration (Optional)
# ----------------------------------------------------------------------------
# Position stacking allows "doubling down" on winning positions.
# When a position is up significantly from its entry price and profitable,
# the bot can add another MAX_POSITION_USD to the position (once per position).
#
# IMPORTANT SAFEGUARDS:
# - Only stacks on positions that are clearly WINNING (not in loss)
# - Requires minimum gain in cents from entry price (default: 20Â¢)
# - Each position can only be stacked ONCE
# - Respects reserve limits (won't stack if reserves are insufficient)
# - Won't stack if price is already near $1 (limited upside)
#
# POSITION_STACKING_ENABLED=true              # Enable position stacking (default: true)
# POSITION_STACKING_MIN_GAIN_CENTS=20         # Min gain in cents from entry to allow stacking (default: 20)
#                                             # Conservative uses 25Â¢, Aggressive uses 15Â¢
# POSITION_STACKING_MAX_CURRENT_PRICE=0.95    # Max price to stack (default: 0.95 = 95Â¢)
#                                             # Prevents stacking positions with limited upside

# ----------------------------------------------------------------------------
# Startup History Loading (Optional)
# ----------------------------------------------------------------------------
# By default, the bot loads historical entry times ONLY for active positions at startup.
# This is much faster than loading the full wallet trade history.
#
# Set to true to load full wallet BUY history on startup (legacy behavior).
# This may be needed if you have positions that were purchased long ago and
# want accurate entry times for all trades, not just current positions.
# LOAD_FULL_TRADE_HISTORY_ON_START=false

# ----------------------------------------------------------------------------
# Approvals Configuration (Optional)
# ----------------------------------------------------------------------------
# Auto-approve USDC and ERC1155 tokens (true/false/dryrun)
# APPROVALS_AUTO=true

# Trust on-chain approvals instead of CLOB API allowance check (recommended)
# IMPORTANT: The Polymarket CLOB API has a known bug where getBalanceAllowance()
# returns allowance=0 even when on-chain approvals are correctly set to unlimited.
# See: https://github.com/Polymarket/clob-client/issues/128
#      https://github.com/Polymarket/py-clob-client/issues/102
#      https://github.com/Polymarket/py-clob-client/issues/109
# 
# When set to true (default), the bot will:
# - Trust on-chain approval verification from preflight checks
# - Bypass CLOB's broken allowance=0 response
# - Still verify balance is sufficient before trading
# - Log clearly when trust mode is active
#
# Only set to false if you want to use CLOB API for allowance checks (not recommended)
# TRUST_ONCHAIN_APPROVALS=true

# ----------------------------------------------------------------------------
# Gas Price Configuration (Optional - Polygon network)
# ----------------------------------------------------------------------------
# Gas price multiplier for transactions (default: 1.2 = 20% buffer)
# POLY_GAS_MULTIPLIER=1.2

# Minimum priority fee in gwei (default: 30 gwei)
# POLY_MAX_PRIORITY_FEE_GWEI=30

# Minimum max fee in gwei (default: 60 gwei)
# POLY_MAX_FEE_GWEI=60

# Maximum gas price cap in gwei (prevents transactions when gas is too high)
# RECOMMENDED: Set to 200 gwei for Polygon (normal is 30-50 gwei)
# Transactions will be BLOCKED if gas exceeds this cap to prevent waste
# Example: User paid $40 in fees at 195 gwei - this would have prevented it
# POLY_MAX_FEE_GWEI_CAP=200

# ----------------------------------------------------------------------------
# Relayer Configuration (Optional - for gasless transactions)
# ----------------------------------------------------------------------------
# The relayer enables GASLESS approval transactions via Polymarket's infrastructure.
# Without the relayer, approvals are sent directly to the blockchain (uses your gas).
#
# REQUIRED TO ENABLE RELAYER:
# You need EITHER:
#   Option A: Builder API credentials (all 3 required)
#   Option B: SIGNER_URL pointing to a remote signer service
#
# Option A: Builder credentials (recommended - no additional services needed)
# Get these from: https://docs.polymarket.com/developers/builders/builder-profile
# NOTE: These are DIFFERENT from CLOB credentials (POLYMARKET_API_*)
# POLY_BUILDER_API_KEY=your_builder_key
# POLY_BUILDER_API_SECRET=your_builder_secret
# POLY_BUILDER_API_PASSPHRASE=your_builder_passphrase
#
# Option B: Remote signer service (legacy method - requires running signer container)
# SIGNER_URL=http://signer:8080/sign
# SIGNER_AUTH_TOKEN=optional_auth_token
#
# Additional relayer settings (optional, defaults shown):
# RELAYER_URL=https://relayer-v2.polymarket.com/
# RELAYER_TX_TYPE=SAFE                          # Options: SAFE, PROXY
# USE_RELAYER_FOR_APPROVALS=true                # Default: true when relayer is enabled
#
# If you see "[Preflight][Summary] âšª Relayer: DISABLED" in your logs:
# - The relayer is not configured. Add builder credentials above to enable it.
# - Without relayer, approvals will use your wallet's gas (still works, just costs gas)

# ----------------------------------------------------------------------------
# Preflight Check Configuration (Optional)
# ----------------------------------------------------------------------------
# Bypass authentication preflight check (NOT RECOMMENDED - only for testing)
# If set to true, trading will be allowed even if preflight checks fail
# This is useful for testing when you have valid credentials but preflight is failing
# due to non-critical issues (network, rate limits, etc.)
# ALLOW_TRADING_WITHOUT_PREFLIGHT=false

# ----------------------------------------------------------------------------
# Smart Hedging Configuration (Optional)
# ----------------------------------------------------------------------------
# Smart Hedging protects against losses AND maximizes wins:
# - "Hedging Down": When losing, buy the opposite side to cap losses
# - "Hedging Up": When winning at high probability near close, buy more shares
#
# SMART_HEDGING_DIRECTION: Controls which hedging behaviors are enabled
# - "down": Only hedge losing positions (traditional behavior)
# - "up": Only buy more shares when winning at high probability (85Â¢+)
# - "both": Both behaviors enabled (default - maximize wins AND minimize losses)
# SMART_HEDGING_DIRECTION=both
#
# === Hedge Up Settings (buy more when winning) ===
# SMART_HEDGING_HEDGE_UP_PRICE_THRESHOLD: Min price to trigger buying more (default: 0.85 = 85Â¢)
# SMART_HEDGING_HEDGE_UP_PRICE_THRESHOLD=0.85
#
# SMART_HEDGING_HEDGE_UP_MAX_PRICE: Max price - don't buy at prices >= this (default: 0.95 = 95Â¢)
# Prevents buying at essentially "closed" prices where profit margin is minimal
# SMART_HEDGING_HEDGE_UP_MAX_PRICE=0.95
#
# SMART_HEDGING_HEDGE_UP_WINDOW_MINUTES: Minutes before close to enable hedge up (default: 30)
# Only used when SMART_HEDGING_HEDGE_UP_ANYTIME=false (which is the default)
# SMART_HEDGING_HEDGE_UP_WINDOW_MINUTES=30
#
# SMART_HEDGING_HEDGE_UP_MAX_USD: Max USD to spend per position on hedge up (default: 25)
# Uses SMART_HEDGING_ALLOW_EXCEED_MAX and SMART_HEDGING_ABSOLUTE_MAX_USD settings
# Respects dynamic reserves - won't exceed available funds
# SMART_HEDGING_HEDGE_UP_MAX_USD=25
#
# SMART_HEDGING_HEDGE_UP_ANYTIME: Allow hedge up at any time (default: false)
# When false (default), hedging up only occurs within SMART_HEDGING_HEDGE_UP_WINDOW_MINUTES
# of market close. This is safer because the outcome is more certain near close.
# When true, positions at high win probability (>= SMART_HEDGING_HEDGE_UP_PRICE_THRESHOLD)
# can be hedged up immediately, regardless of time to market close.
# SMART_HEDGING_HEDGE_UP_ANYTIME=false

# ----------------------------------------------------------------------------
# Logging & Monitoring (Optional)
# ----------------------------------------------------------------------------
# LOG_LEVEL=info

# ----------------------------------------------------------------------------
# Telegram Notifications (Optional)
# ----------------------------------------------------------------------------
# Get notifications on buys, sells, redemptions, and periodic P&L updates.
#
# To set up Telegram notifications:
# 1. Create a bot via @BotFather on Telegram and get the bot token
# 2. Get your chat ID (start a chat with @userinfobot or @getmyid_bot)
# 3. For group topics (forum-style groups), get the topic ID from the URL
#
# TELEGRAM_BOT_TOKEN: Your bot token from @BotFather
# TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
#
# TELEGRAM_CHAT_ID: Your chat/group ID (can be negative for groups)
# TELEGRAM_CHAT_ID=123456789
#
# TELEGRAM_TOPIC_ID: Topic ID for forum-style groups (optional)
# To get the topic ID, forward a message from the topic to @JsonDumpBot or use the Telegram API's getUpdates method.
# For private groups, the URL format is typically t.me/c/channelid/topicid
# TELEGRAM_TOPIC_ID=456
#
# TELEGRAM_NOTIFICATION_NAME: Custom name shown in notifications (default: "Polymarket Alert")
# TELEGRAM_NOTIFICATION_NAME=My Polymarket Bot
#
# TELEGRAM_PNL_INTERVAL_MINUTES: How often to send P&L updates (default: 60, set to 0 to disable)
# TELEGRAM_PNL_INTERVAL_MINUTES=60
#
# TELEGRAM_SILENT: Send notifications silently without sound/vibration (default: false)
# TELEGRAM_SILENT=false

# ============================================================================
# For the full list of options, see the documentation:
# - docs/ENVIRONMENT_VARIABLES.md (ðŸ“‹ COMPREHENSIVE ENV REFERENCE)
# - README.md
# - docs/GUIDE.md
# - docs/CREDENTIALS_EXPLAINED.md
# ============================================================================
